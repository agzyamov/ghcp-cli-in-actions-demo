# GitHub Copilot CLI in Actions Demo

> Automate your software development lifecycle with GitHub Copilot CLI in GitHub Actions

[![GitHub Actions](https://img.shields.io/badge/GitHub-Actions-blue?logo=github-actions)](https://github.com/features/actions)
[![Copilot](https://img.shields.io/badge/GitHub-Copilot-purple?logo=github)](https://github.com/features/copilot)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## 🚀 Overview

This repository demonstrates how to integrate GitHub Copilot CLI directly into your CI/CD pipelines using GitHub Actions. Automate code generation, create pull requests with AI-generated code, and get answers to technical questions—all from simple workflow triggers.

## ✨ Features

- 🤖 **Automated Code Generation**: Generate production-ready Python code using natural language prompts
- 🔄 **Pull Request Automation**: Automatically creates feature branches and PRs with generated code
- 📝 **Interactive Q&A**: Ask questions and get answers committed as markdown files
- 🎯 **Zero Configuration**: Works out of the box with GitHub Actions
- 🏷️ **Smart Labeling**: Automatically tags PRs with `ai-generated` and `needs-review` labels

## 📋 Prerequisites

- GitHub repository with Actions enabled
- GitHub Copilot subscription
- Personal Access Token (PAT) with Copilot scope

## 🛠️ Setup

### 1. Configure Repository Settings

1. Go to `Settings` → `Actions` → `General`
2. Under **Workflow permissions**, select:
   - ✅ **Read and write permissions**
   - ✅ **Allow GitHub Actions to create and approve pull requests**

### 2. Add Secrets

1. Create a [Personal Access Token](https://github.com/settings/tokens/new) with these scopes:
   - `repo` (Full control of private repositories)
   - `copilot` (Access to Copilot features)

2. Add to repository secrets as `COPILOT_TOKEN`:
   ```
   Settings → Secrets and variables → Actions → New repository secret
   Name: COPILOT_TOKEN
   Value: <your-token>
   ```

### 3. Create Labels

Run these commands in your repository:
```bash
gh label create "ai-generated" --description "Code generated by AI" --color "0E8A16"
gh label create "needs-review" --description "Requires code review" --color "FBCA04"
```

## 💻 Usage

### 🔧 Copilot Feature Development

Generate code and create a pull request automatically:

```bash
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a function to calculate Fibonacci numbers"
```

**What it does:**
1. Creates a new feature branch
2. Generates Python code using GitHub Copilot CLI
3. Commits code to the branch
4. Creates a pull request with generated code
5. Adds appropriate labels for review

**Example prompts:**
```bash
# Generate a calculator function
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a calculator class with add, subtract, multiply, divide methods"

# Generate data validation
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a function to validate email addresses using regex"

# Generate API client
gh workflow run copilot-feature-dev.yml \
  -f feature_prompt="Create a REST API client for weather data with error handling"
```

### 💬 Copilot Q&A

Ask questions and get answers committed to the repository:

```bash
gh workflow run copilot-qa.yml \
  -f question="How do I implement OAuth 2.0 authentication in Python?"
```

**What it does:**
1. Sends your question to GitHub Copilot CLI
2. Saves the response to `response.md` in the root directory
3. Archives a timestamped copy in `responses/` directory
4. Commits both files to the repository
5. Makes response available as downloadable artifact

**Response saved to:**
- `response.md` - Latest response (overwritten each time)
- `responses/response_YYYYMMDD_HHMMSS.md` - Archived copy with timestamp

**Example questions:**
```bash
# Ask about implementation
gh workflow run copilot-qa.yml \
  -f question="How do I implement rate limiting in Python using decorators?"

# Ask about best practices
gh workflow run copilot-qa.yml \
  -f question="What are the best practices for error handling in REST APIs?"

# Ask for code examples
gh workflow run copilot-qa.yml \
  -f question="Show me how to implement a simple caching system in Python"
```

## 📁 Project Structure

```
.
├── .github/
│   └── workflows/
│       ├── copilot-feature-dev.yml  # Code generation workflow
│       └── copilot-qa.yml           # Q&A workflow
├── generated/                        # Generated code files
│   ├── create_a_calculator_class_*.py
│   └── create_a_function_to_*.py
├── responses/                        # Copilot Q&A responses
│   └── response_YYYYMMDD_HHMMSS.md
├── response.md                       # Latest Q&A response
├── LICENSE                           # MIT License
└── README.md                         # This file
```

## 📊 Example Output

### Generated Code Quality

The workflow generates professional code with:

```python
def is_prime(n: Union[int, float]) -> bool:
    """
    Check if a number is prime.
    
    Args:
        n: The number to check. Can be int or float.
        
    Returns:
        bool: True if prime, False otherwise.
        
    Raises:
        TypeError: If n cannot be converted to integer.
        ValueError: If n is negative.
    """
    # Implementation with edge cases and validation
    ...
```

### Pull Request Template

Every PR includes:
- 🤖 AI-Generated Feature badge
- Original prompt
- Generated file path
- Link to workflow run
- Code review checklist

## 🎯 Use Cases

1. **Rapid Prototyping**: Quickly generate boilerplate code for new features
2. **Learning Tool**: See how Copilot implements common patterns
3. **Code Generation Pipeline**: Integrate into existing SDLC workflows
4. **Documentation Assistant**: Query technical documentation on-demand
5. **Team Knowledge Base**: Build a repository of Q&A responses

## 🔍 Validation

Install the YAML validator for workflow syntax checking:

```bash
npm install -g @action-validator/cli
action-validator .github/workflows/copilot-feature-dev.yml
```

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## 📝 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- [GitHub Copilot](https://github.com/features/copilot) - AI pair programmer
- [GitHub Actions](https://github.com/features/actions) - CI/CD platform
- [@github/copilot](https://www.npmjs.com/package/@github/copilot) - Copilot CLI

## 📚 Additional Resources

- [GitHub Copilot Documentation](https://docs.github.com/en/copilot)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [GitHub CLI Documentation](https://cli.github.com/manual/)

## 🐛 Troubleshooting

### Workflow fails with "COPILOT_TOKEN not found"
- Ensure you've created a PAT with Copilot scope
- Add it as a secret named `COPILOT_TOKEN` in repository settings

### PR creation fails
- Check that "Allow GitHub Actions to create and approve pull requests" is enabled
- Verify workflow has `pull-requests: write` permission

### Labels not found
- Run the label creation commands from Setup section
- Or remove `--label` flags from workflow

---

Made with ❤️ using GitHub Copilot CLI
